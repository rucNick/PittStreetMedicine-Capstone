<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 720">
    <!-- Background and styling -->
    <defs>
      <linearGradient id="backgroundGradient" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" stop-color="#f9f9f9" />
        <stop offset="100%" stop-color="#f0f0f0" />
      </linearGradient>
      
      <!-- Gradient for client components -->
      <linearGradient id="clientGradient" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" stop-color="#4a90e2" />
        <stop offset="100%" stop-color="#3498db" />
      </linearGradient>
      
      <!-- Gradient for server components -->
      <linearGradient id="serverGradient" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" stop-color="#27ae60" />
        <stop offset="100%" stop-color="#2ecc71" />
      </linearGradient>
      
      <!-- Gradient for security operations -->
      <linearGradient id="securityGradient" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" stop-color="#8e44ad" />
        <stop offset="100%" stop-color="#9b59b6" />
      </linearGradient>
      
      <!-- Arrow markers -->
      <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
        <polygon points="0 0, 10 3.5, 0 7" fill="#555" />
      </marker>
      
      <marker id="arrowhead-secure" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
        <polygon points="0 0, 10 3.5, 0 7" fill="#8e44ad" />
      </marker>
      
      <!-- Filter for shadow effect -->
      <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
        <feDropShadow dx="3" dy="3" stdDeviation="3" flood-opacity="0.2"/>
      </filter>
    </defs>
    
    <!-- Main Background -->
    <rect width="1000" height="720" fill="url(#backgroundGradient)" />
    
    <!-- Title -->
    <text x="500" y="40" font-family="Arial, sans-serif" font-size="24" font-weight="bold" text-anchor="middle" fill="#333">StreetMed Security Workflow</text>
    
    <!-- Legend -->
    <rect x="100" y="70" width="130" height="30" rx="5" ry="5" fill="url(#clientGradient)" />
    <text x="165" y="90" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="white">Client Process</text>
    
    <rect x="250" y="70" width="130" height="30" rx="5" ry="5" fill="url(#serverGradient)" />
    <text x="315" y="90" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="white">Server Process</text>
    
    <rect x="400" y="70" width="130" height="30" rx="5" ry="5" fill="url(#securityGradient)" />
    <text x="465" y="90" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="white">Security Operation</text>
    
    <!-- Client Side Box -->
    <rect x="100" y="120" width="300" height="550" rx="15" ry="15" fill="#e8f4fc" stroke="#4a90e2" stroke-width="2" filter="url(#shadow)" />
    <text x="250" y="150" font-family="Arial, sans-serif" font-size="18" font-weight="bold" text-anchor="middle" fill="#2c3e50">Client Side</text>
    
    <!-- Server Side Box -->
    <rect x="600" y="120" width="300" height="550" rx="15" ry="15" fill="#e9f7ef" stroke="#27ae60" stroke-width="2" filter="url(#shadow)" />
    <text x="750" y="150" font-family="Arial, sans-serif" font-size="18" font-weight="bold" text-anchor="middle" fill="#2c3e50">Server Side</text>
    
    <!-- Phase 1: Key Exchange -->
    <rect x="50" y="190" width="900" height="120" rx="10" ry="10" fill="rgba(255,255,255,0.5)" stroke="#bdc3c7" stroke-width="1" stroke-dasharray="5,3" />
    <text x="500" y="210" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="#7f8c8d">Phase 1: ECDH Key Exchange</text>
    
    <!-- Client Components for Key Exchange -->
    <rect x="130" y="230" width="240" height="60" rx="8" ry="8" fill="url(#clientGradient)" filter="url(#shadow)" />
    <text x="250" y="265" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="white">Generate Client Key Pair</text>
    
    <!-- Server Components for Key Exchange -->
    <rect x="630" y="230" width="240" height="60" rx="8" ry="8" fill="url(#serverGradient)" filter="url(#shadow)" />
    <text x="750" y="265" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="white">Generate Server Key Pair</text>
    
    <!-- Phase 2: Shared Secret Computation -->
    <rect x="50" y="330" width="900" height="120" rx="10" ry="10" fill="rgba(255,255,255,0.5)" stroke="#bdc3c7" stroke-width="1" stroke-dasharray="5,3" />
    <text x="500" y="350" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="#7f8c8d">Phase 2: Shared Secret Computation</text>
    
    <!-- Client Components for Secret -->
    <rect x="130" y="370" width="240" height="60" rx="8" ry="8" fill="url(#securityGradient)" filter="url(#shadow)" />
    <text x="250" y="405" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="white">Derive AES-256 Key</text>
    
    <!-- Server Components for Secret -->
    <rect x="630" y="370" width="240" height="60" rx="8" ry="8" fill="url(#securityGradient)" filter="url(#shadow)" />
    <text x="750" y="405" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="white">Derive AES-256 Key</text>
    
    <!-- Phase 3: Secure Communication -->
    <rect x="50" y="470" width="900" height="180" rx="10" ry="10" fill="rgba(255,255,255,0.5)" stroke="#bdc3c7" stroke-width="1" stroke-dasharray="5,3" />
    <text x="500" y="490" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="#7f8c8d">Phase 3: Secure API Communication</text>
    
    <!-- Client Components for Authentication -->
    <rect x="130" y="510" width="240" height="50" rx="8" ry="8" fill="url(#clientGradient)" filter="url(#shadow)" />
    <text x="250" y="540" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="white">Encrypt Request</text>
    
    <rect x="130" y="580" width="240" height="50" rx="8" ry="8" fill="url(#clientGradient)" filter="url(#shadow)" />
    <text x="250" y="610" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="white">Decrypt Response</text>
    
    <!-- Server Components for Authentication -->
    <rect x="630" y="510" width="240" height="50" rx="8" ry="8" fill="url(#serverGradient)" filter="url(#shadow)" />
    <text x="750" y="540" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="white">Decrypt Request</text>
    
    <rect x="630" y="580" width="240" height="50" rx="8" ry="8" fill="url(#serverGradient)" filter="url(#shadow)" />
    <text x="750" y="610" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="white">Encrypt Response</text>
    
    <!-- Connection lines for Phase 1 -->
    <line x1="370" y1="250" x2="630" y2="250" stroke="#555" stroke-width="2" marker-end="url(#arrowhead)" />
    <text x="500" y="240" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#555">1. initiate-handshake</text>
    
    <line x1="630" y1="270" x2="370" y2="270" stroke="#555" stroke-width="2" marker-end="url(#arrowhead)" />
    <text x="500" y="290" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#555">2. return sessionID + serverPublicKey</text>
    
    <!-- Connection lines for Phase 2 -->
    <line x1="370" y1="390" x2="630" y2="390" stroke="#555" stroke-width="2" marker-end="url(#arrowhead)" />
    <text x="500" y="380" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#555">3. complete-handshake (clientPublicKey)</text>
    
    <line x1="630" y1="410" x2="370" y2="410" stroke="#555" stroke-width="2" marker-end="url(#arrowhead)" />
    <text x="500" y="430" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#555">4. handshake successful</text>
    
    <!-- Connection lines for Phase 3 -->
    <line x1="370" y1="530" x2="630" y2="530" stroke="#8e44ad" stroke-width="2.5" stroke-dasharray="0" marker-end="url(#arrowhead-secure)" />
    <text x="500" y="520" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="#8e44ad">5. Encrypted API Request</text>
    
    <line x1="630" y1="600" x2="370" y2="600" stroke="#8e44ad" stroke-width="2.5" stroke-dasharray="0" marker-end="url(#arrowhead-secure)" />
    <text x="500" y="620" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="#8e44ad">6. Encrypted API Response</text>
    
    <!-- Session Management Component -->
    <rect x="630" y="650" width="240" height="50" rx="8" ry="8" fill="#e74c3c" filter="url(#shadow)" />
    <text x="750" y="680" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="white">Session Management (30 min timeout)</text>
    
    <!-- Additional security indicators -->
    <circle cx="370" cy="530" r="6" fill="#f39c12" />
    <circle cx="630" cy="530" r="6" fill="#f39c12" />
    <circle cx="370" cy="600" r="6" fill="#f39c12" />
    <circle cx="630" cy="600" r="6" fill="#f39c12" />
    
    <!-- Footer note -->
    <text x="500" y="710" font-family="Arial, sans-serif" font-size="14" text-anchor="middle" fill="#2c3e50">Secure Communication with ECDH Key Exchange and AES-GCM Encryption</text>
  </svg>